(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{809:function(e,t,r){"use strict";r.r(t);var n=r(289),o=r(279),c=r(6),l=r(287),d=r(753),m=r(764),f=r(282),h=r(855),_=r(216),v=r(856),k=r(752),x=r(756),y=r(854),C=r(89),O=(r(30),r(27),r(111),r(9),r(8),r(12),r(10),r(13),r(1)),w=r(22),j=(r(66),r(31),r(93),r(7),r(4),r(122)),F=(r(2),r(778)),S=r(777),$=r(783);function P(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function T(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?P(Object(source),!0).forEach((function(t){Object(O.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):P(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var D={mixins:[j.a,F.a,S.a,$.a],name:"storeCardComponent",props:{store:{type:Object,required:!0}},data:function(){return{filter:"",pagination:{rowsPerPage:10},search:{page:1,state:"2"},loading:!1,order:{},showOrderModal:!1,data:{orders:[],total_pages:0,total_count:0}}},created:function(){this.data=JSON.parse(JSON.stringify(this.$store.getters["orderstore/get"])),this.search=JSON.parse(JSON.stringify(this.$store.getters["orderstore/getSearchParams"]))},methods:{showOrder:function(e){this.order=e,this.showOrderModal=!0},setValue:function(symbol,e){return e?"".concat(symbol," ").concat(e):"Not setted"},getStore:function(){var e=this;return Object(w.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.data=e.loading=!0,t.next=3,e.$store.dispatch("orderstore/findAll",{storeId:e.store.id,search:e.search});case 3:e.data=t.sent,console.log(e.data),e.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},updateTrackingOrder:function(e){var t=this;return Object(w.a)(regeneratorRuntime.mark((function r(){var data,n,o,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(data={product_id:e.product.id,store_id:t.store.id,order_id:e.order.id,net_price:e.product.net_price,tracking_number:e.product.tracking_number,complete_order_data:e},r.prev=1,!e.product.extra_id){r.next=7;break}return r.next=5,t.$axios.put("/orders/".concat(e.product.extra_id),{data:data});case 5:r.next=13;break;case 7:return r.next=9,t.$axios.post("/orders/",{data:data});case 9:n=r.sent,o=n.data,c=t.data.orders.findIndex((function(t){return t.id==e.id})),t.$set(t.data.orders,c,T(T({},t.data.orders[c]),{},{product:T(T({},t.data.orders[c].product),{},{extra_id:o.data.id})}));case 13:e.product.tracking_number&&e.product.tracking_number.length>6&&t.$axios.post("/orders/tracking",data),r.next=19;break;case 16:r.prev=16,r.t0=r.catch(1),console.log(r.t0);case 19:case"end":return r.stop()}}),r,null,[[1,16]])})))()}},computed:{filteredColumns:function(){return this.columns.filter((function(col){return col.visible}))}},watch:{"search.page":function(){this.getStore()}}},J=r(19),component=Object(J.a)(D,(function(){var e=this,t=e._self._c;return t("GeneralCardComponent",{staticClass:"mx-auto"},[t("generalCardTitleComponent",{staticClass:"primary white--text"},[e._v(e._s(e.store.name)+"\n  "),t(x.a),e._v(" "),e._t("default")],2),e._v(" "),t(f.a),e._v(" "),t(c.d,[t(o.a,{staticClass:"rounded-lg",attrs:{outlined:""}},[t(c.d,[t(k.a,[t(d.a,{staticClass:"col-md-11 col-12"},[t(k.a,[t(d.a,{staticClass:"col-md-2 col-12"},[t("FormsFieldsTextComponent",{attrs:{label:"Cliente"},model:{value:e.search.customer,callback:function(t){e.$set(e.search,"customer",t)},expression:"search.customer"}})],1),e._v(" "),t(d.a,{staticClass:"col-md-2 col-12"},[t("FormsFieldsTextComponent",{attrs:{label:"Producto"},model:{value:e.search.product,callback:function(t){e.$set(e.search,"product",t)},expression:"search.product"}})],1),e._v(" "),t(d.a,{staticClass:"col-md-2 col-12"},[t("FormsFieldsTextComponent",{attrs:{label:"Referencia"},model:{value:e.search.reference,callback:function(t){e.$set(e.search,"reference",t)},expression:"search.reference"}})],1),e._v(" "),t(d.a,{staticClass:"col-md-2 col-12"},[t("FormsFieldsTextComponent",{attrs:{type:"date",label:"Fecha inicio"},model:{value:e.search.startDate,callback:function(t){e.$set(e.search,"startDate",t)},expression:"search.startDate"}})],1),e._v(" "),t(d.a,{staticClass:"col-md-2 col-12"},[t("FormsFieldsTextComponent",{attrs:{type:"date",label:"Fecha fin"},model:{value:e.search.endDate,callback:function(t){e.$set(e.search,"endDate",t)},expression:"search.endDate"}})],1),e._v(" "),t(d.a,{staticClass:"col-md-2 col-12"},[t("FormsFieldsSelectComponent",{attrs:{items:e.stateItems,label:"Estado"},model:{value:e.search.state,callback:function(t){e.$set(e.search,"state",t)},expression:"search.state"}})],1)],1)],1),e._v(" "),t(d.a,{staticClass:"col-md-1 col-12 d-flex justify-center align-center"},[t(n.a,{staticClass:"primary white--text mt-4",attrs:{fab:""},on:{click:function(t){return e.getStore()}}},[t(_.a,[e._v("mdi-filter")])],1)],1)],1)],1)],1)],1),e._v(" "),t(c.d,[t(o.a,{staticClass:"rounded-lg",attrs:{outlined:""}},[t(c.d,[t(k.a,{attrs:{"no-gutters":""}},e._l(e.columns,(function(col){return t(y.a,{key:col.value,staticClass:"mr-2 my-2",attrs:{label:col.text},model:{value:col.visible,callback:function(t){e.$set(col,"visible",t)},expression:"col.visible"}})})),1)],1)],1)],1),e._v(" "),t(c.c,[t(m.a,{attrs:{"item-key":"id","show-expand":"","single-expand":"",loading:e.loading,"loading-text":"Cargando ordenes","disable-pagination":"","disable-sort":"","calculate-widths":"","disable-filtering":"",items:e.data.orders,headers:e.filteredColumns,"hide-default-footer":"","items-per-page":10},scopedSlots:e._u([{key:"item.creation_date",fn:function(t){var r=t.item;return[e._v("\n        "+e._s(e._f("formatDate")(r.creation_date))+"\n      ")]}},{key:"item.cost",fn:function(t){var r=t.item;return[e._v("\n        € "+e._s(r.cost)+"\n      ")]}},{key:"item.product.image_url",fn:function(e){var r=e.item;return[t("img",{attrs:{src:r.product.image_url,width:"100%",height:"80"}})]}},{key:"item.products",fn:function(r){var n=r.item;return[t("div",{staticClass:"full-width d-flex flex-column"},e._l(n.products,(function(r){return t(l.a,{key:r.id,staticClass:"mr-2 my-2",attrs:{small:"",label:"",outlined:""}},[e._v("\n            "+e._s(r.name)+"\n          ")])})),1)]}},{key:"item.order.status",fn:function(e){var r=e.item;return[t("storeChipsStatusComponent",{attrs:{status:r.order.status}})]}},{key:"item.product.tracking_number",fn:function(r){var n=r.item;return[t(h.a,{attrs:{"save-text":"Guardar","cancel-text":"Guardar"},on:{close:function(t){return e.updateTrackingOrder(n)},save:function(t){return e.updateTrackingOrder(n)}},scopedSlots:e._u([{key:"input",fn:function(){return[t(C.a,{attrs:{label:"Edit"},model:{value:n.product.tracking_number,callback:function(t){e.$set(n.product,"tracking_number",t)},expression:"item.product.tracking_number"}})]},proxy:!0}],null,!0)},[t(C.a,{attrs:{"hide-details":"",outlined:"",dense:"",height:"20",readonly:"",value:e.setValue("#",n.product.tracking_number)}})],1)]}},{key:"item.product.net_price",fn:function(r){var n=r.item;return[t(h.a,{on:{close:function(t){return e.updateTrackingOrder(n)}},scopedSlots:e._u([{key:"input",fn:function(){return[t(C.a,{attrs:{label:"Edit",counter:""},model:{value:n.product.net_price,callback:function(t){e.$set(n.product,"net_price",t)},expression:"item.product.net_price"}})]},proxy:!0}],null,!0)},[t(C.a,{attrs:{"hide-details":"",outlined:"",dense:"",height:"20",readonly:"",value:e.setValue("€",n.product.net_price)}})],1)]}},{key:"expanded-item",fn:function(r){var n=r.headers,o=r.item;return[t("td",{staticClass:"pa-4",attrs:{colspan:n.length}},[t("ordersIncidencesComponent",{attrs:{store:e.store.id,order:o},on:{refresh:function(t){return e.getStore()}}})],1)]}},{key:"item.copy",fn:function(r){var o=r.item;return[t(n.a,{attrs:{rounded:"",color:"primary"},on:{click:function(t){return e.copyToClipboard(o)}}},[t(_.a,[e._v("mdi-content-copy")])],1)]}},{key:"item.profit",fn:function(t){var r=t.item;return[e._v("\n         "+e._s(e.calcProfit(r))+"\n      ")]}}])})],1),e._v(" "),t(c.a,{staticClass:"d-flex justify-center"},[t(v.a,{attrs:{length:e.data.total_pages,circle:""},model:{value:e.search.page,callback:function(t){e.$set(e.search,"page",t)},expression:"search.page"}})],1)],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{FormsFieldsTextComponent:r(102).default,FormsFieldsSelectComponent:r(112).default,GeneralCardComponent:r(82).default})}}]);