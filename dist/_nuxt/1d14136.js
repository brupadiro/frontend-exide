(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{867:function(e,t,r){"use strict";r.r(t);var n,o=r(6),c=r(753),l=r(752),m=r(1),d=r(28),y=r(22),f=(r(66),r(27),r(111),r(4),r(299),r(9),r(83),r(8),r(7),r(12),r(10),r(13),r(122)),h=r(2),v=r.n(h),O=r(68),j=r.n(O);r(768);function C(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function w(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?C(Object(source),!0).forEach((function(t){Object(m.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):C(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var x=(n={props:{paymentsModal:{type:Boolean,required:!0}},mixins:[f.a]},Object(m.a)(n,"props",{search:{type:Object,required:!0}}),Object(m.a)(n,"data",(function(){return{itemsFilters:[{text:"Dia",value:"day"},{text:"Mes",value:"month"},{text:"Año",value:"year"},{text:"Producto",value:"product"}],type:"day",paymentsModal:!1,labels:[],labelsPayments:[],periods:["día","semana","mes"],selectedPeriod:"mes",incomeData:[],groupedData:[],payments:{data:[]},selectedMonth:{},paymentsGraph:[]}})),Object(m.a)(n,"mounted",(function(){var e=this;this.$root.$on("refresh",(function(data){e.getIncome(),e.getPayments()}))})),Object(m.a)(n,"methods",{getPayments:function(){var e=this;return Object(y.a)(regeneratorRuntime.mark((function t(){var r,data,n,o,c,l,m,y,f,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/payments/",{params:{filters:{store:e.search.store,date:{$gte:e.search.start_date,$lte:e.search.end_date}},populate:"*"},paramsSerializer:function(e){return j.a.stringify(e,{arrayFormat:"brackets"})}});case 2:for(r=t.sent,data=r.data,n=data.data,console.log(n),o=n.reduce((function(e,t){var r=v()(t.date).format("DD/MM/YYYY");return(e[r]||(e[r]=[])).push(t),e}),{}),c={},l=0,m=Object.entries(o);l<m.length;l++)y=Object(d.a)(m[l],2),f=y[0],h=y[1],c[f]=h.reduce((function(e,t){return e+t.amount}),0);e.labelsPayments=Object.keys(c),e.paymentsGraph=Object.values(c);case 11:case"end":return t.stop()}}),t)})))()},getIncome:function(){var e=this;return Object(y.a)(regeneratorRuntime.mark((function t(){var data,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.search.store){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.getIncomeData(e.type,e.search);case 4:for(i in data=t.sent,e.incomeData=Object.values(data),data.data)e.labels.push(i);e.labels=Object.keys(data);case 8:case"end":return t.stop()}}),t)})))()},getIncomeData:function(e,t){var r=this;return Object(y.a)(regeneratorRuntime.mark((function n(){var o,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.$axios.get("/webservices/payments/".concat(t.store),{params:w(w({},t),{},{method:e})});case 2:return o=n.sent,data=o.data,n.abrupt("return",data);case 5:case"end":return n.stop()}}),n)})))()}}),Object(m.a)(n,"computed",{graphType:function(){switch(this.type){case"day":return"line";case"month":case"year":case"product":return"bar"}}}),Object(m.a)(n,"watch",{type:function(){this.getIncome()}}),n),P=r(19),component=Object(P.a)(x,(function(){var e=this,t=e._self._c;return t(l.a,[t(c.a,{staticClass:"col-12"},[t("generalCardComponent",{attrs:{elevation:"6"}},[t("GeneralCardTitleComponent",{staticClass:"primary white--text"},[e._v("\n      Ingresos\n    ")]),e._v(" "),t(o.d,[t("FormsFieldsSelectComponent",{attrs:{label:"Filtrar por...",items:e.itemsFilters},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}})],1),e._v(" "),t(o.c,[t("generalGraphComponent",{attrs:{type:"bar",labels:e.labels,data:[{values:e.incomeData,chartType:e.graphType,name:"Ingresos"}],colors:["#ff6240"]}})],1)],1)],1),e._v(" "),t(c.a,{staticClass:"col-12"},[t("GeneralCardComponent",[t("GeneralCardTitleComponent",{staticClass:"primary white--text"},[e._v("\n      Gastos\n    ")]),e._v(" "),t(o.c,[t("generalGraphComponent",{attrs:{type:"bar",labels:e.labelsPayments,data:[{values:e.paymentsGraph,chartType:"line",name:"Gastos"}],colors:["#ff6240"]}})],1)],1)],1),e._v(" "),t(c.a,{staticClass:"col-12"}),e._v(" "),t("accountingCreatePaymentsComponent",{model:{value:e.paymentsModal,callback:function(t){e.paymentsModal=t},expression:"paymentsModal"}})],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{GeneralCardTitleComponent:r(130).default,FormsFieldsSelectComponent:r(112).default,GeneralCardComponent:r(82).default})}}]);