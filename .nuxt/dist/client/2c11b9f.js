(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{935:function(e,t,n){"use strict";n.r(t);var r,o=n(2),c=n(781),m=n(1),l=n(30),d=n(21),f=(n(65),n(5),n(305),n(12),n(74),n(23),n(90),n(8),n(9),n(13),n(11),n(14),n(131)),h=n(4),y=n.n(h),v=n(49),O=n.n(v);n(788);function j(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function w(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?j(Object(source),!0).forEach((function(t){Object(m.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):j(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var P=(r={props:{paymentsModal:{type:Boolean,required:!0}},mixins:[f.a]},Object(m.a)(r,"props",{search:{type:Object,required:!0}}),Object(m.a)(r,"data",(function(){return{paymentsModal:!1,labels:[],labelsPayments:[],headers:[{text:"Fecha",value:"createdAt"},{text:"Tipo",value:"type"},{text:"Tienda",value:"webservice.name"},{text:"Valor",value:"amount"},{text:"Estado",value:"status"},{text:"Comentarios",value:"comments"}],periods:["dÃ­a","semana","mes"],selectedPeriod:"mes",incomeData:[],payments:{data:[]},paymentsGraph:[]}})),Object(m.a)(r,"mounted",(function(){var e=this;this.getIncome(),this.getPayments(),this.$root.$on("refresh",(function(data){e.getIncome(),e.getPayments()}))})),Object(m.a)(r,"methods",{getPayments:function(){var e=this;return Object(d.a)(regeneratorRuntime.mark((function t(){var n,data,r,o,c,m,d,f,h,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/payments/",{params:{populate:"*"},paramsSerializer:function(e){return O.a.stringify(e,{arrayFormat:"brackets"})}});case 2:for(n=t.sent,data=n.data,r=data.data,o=r.reduce((function(e,t){var n=y()(t.publishedAt).format("DD/MM/YYYY");return(e[n]||(e[n]=[])).push(t),e}),{}),c={},m=0,d=Object.entries(o);m<d.length;m++)f=Object(l.a)(d[m],2),h=f[0],v=f[1],c[h]=v.reduce((function(e,t){return e+t.amount}),0);e.labelsPayments=Object.keys(c),e.paymentsGraph=Object.values(c);case 10:case"end":return t.stop()}}),t)})))()},getIncome:function(){var e=this;return Object(d.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/webservices/payments/".concat(e.search.store),{params:w(w({},e.search),{},{method:"day"})}).then((function(data){for(var i in e.incomeData=Object.values(data.data),data.data)e.labels.push(i);e.labels=e.labels.reverse()}));case 2:case"end":return t.stop()}}),t)})))()}}),Object(m.a)(r,"watch",{search:{handler:function(){this.getIncome(),this.getPayments()},deep:!0},"search.start_date":function(){this.getIncome()},"search.end_date":function(){this.getIncome()}}),r),x=n(10),component=Object(x.a)(P,(function(){var e=this,t=e._self._c;return t("div",[t("GeneralCardTitleComponent",{staticClass:"primary white--text"},[e._v("\n    Gastos\n  ")]),e._v(" "),t(o.c,[t("generalGraphComponent",{attrs:{type:"bar",labels:e.labelsPayments,data:[{values:e.paymentsGraph,chartType:"line",name:"Gastos"}],colors:["#ff6240"]}})],1),e._v(" "),t(o.c,[t(c.a,{attrs:{headers:e.headers,items:e.payments.data,"hide-default-footer":""},scopedSlots:e._u([{key:"item.createdAt",fn:function(t){var n=t.item;return[e._v("\n        "+e._s(e._f("formatDate")(n.createdAt))+"\n      ")]}},{key:"item.amount",fn:function(t){var n=t.item;return[e._v("\n        "+e._s(n.amount)+" EUR\n      ")]}}])})],1)],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{GeneralCardTitleComponent:n(83).default})}}]);