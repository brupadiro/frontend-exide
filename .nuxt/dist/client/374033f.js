(window.webpackJsonp=window.webpackJsonp||[]).push([[55,54],{831:function(t,e,r){var content=r(890);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(19).default)("d79b5eea",content,!0,{sourceMap:!1})},835:function(t,e,r){"use strict";r.r(e);var n=r(294),o=r(284),c=r(2),d=r(292),l=r(770),m=r(781),f=r(287),h=r(896),_=r(225),v=r(897),x=r(769),k=r(771),y=r(895),C=r(97),O=(r(24),r(23),r(90),r(12),r(8),r(13),r(11),r(14),r(1)),w=r(21),S=(r(65),r(31),r(103),r(9),r(5),r(131)),j=(r(4),r(800)),D=r(799),$=r(808);function M(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function P(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?M(Object(source),!0).forEach((function(e){Object(O.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):M(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var F={mixins:[S.a,j.a,D.a,$.a],name:"storeCardComponent",props:{store:{type:Object,required:!0}},data:function(){return{filter:"",pagination:{rowsPerPage:10},search:{page:1,state:"2"},loading:!1,order:{},showOrderModal:!1,data:{orders:[],total_pages:0,total_count:0}}},created:function(){this.data=JSON.parse(JSON.stringify(this.$store.getters["orderstore/get"])),this.search=JSON.parse(JSON.stringify(this.$store.getters["orderstore/getSearchParams"]))},methods:{showOrder:function(t){this.order=t,this.showOrderModal=!0},setValue:function(symbol,t){return t?"".concat(symbol," ").concat(t):"Not setted"},getStore:function(){var t=this;return Object(w.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.data=t.loading=!0,e.next=3,t.$store.dispatch("orderstore/findAll",{storeId:t.store.id,search:t.search});case 3:t.data=e.sent,console.log(t.data),t.loading=!1;case 6:case"end":return e.stop()}}),e)})))()},updateTrackingOrder:function(t){var e=this;return Object(w.a)(regeneratorRuntime.mark((function r(){var data,n,o,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(data={product_id:t.product.id,store_id:e.store.id,order_id:t.order.id,net_price:t.product.net_price,tracking_number:t.product.tracking_number,complete_order_data:t},r.prev=1,!t.product.extra_id){r.next=7;break}return r.next=5,e.$axios.put("/orders/".concat(t.product.extra_id),{data:data});case 5:r.next=13;break;case 7:return r.next=9,e.$axios.post("/orders/",{data:data});case 9:n=r.sent,o=n.data,c=e.data.orders.findIndex((function(e){return e.id==t.id})),e.$set(e.data.orders,c,P(P({},e.data.orders[c]),{},{product:P(P({},e.data.orders[c].product),{},{extra_id:o.data.id})}));case 13:t.product.tracking_number&&t.product.tracking_number.length>6&&e.$axios.post("/orders/tracking",data),r.next=19;break;case 16:r.prev=16,r.t0=r.catch(1),console.log(r.t0);case 19:case"end":return r.stop()}}),r,null,[[1,16]])})))()}},computed:{filteredColumns:function(){return this.columns.filter((function(col){return col.visible}))}},watch:{"search.page":function(){this.getStore()}}},T=r(10),component=Object(T.a)(F,(function(){var t=this,e=t._self._c;return e("GeneralCardComponent",{staticClass:"mx-auto"},[e("generalCardTitleComponent",{staticClass:"primary white--text"},[t._v(t._s(t.store.name)+"\n  "),e(k.a),t._v(" "),t._t("default")],2),t._v(" "),e(f.a),t._v(" "),e(c.d,[e(o.a,{staticClass:"rounded-lg",attrs:{outlined:""}},[e(c.d,[e(x.a,[e(l.a,{staticClass:"col-md-11 col-12"},[e(x.a,[e(l.a,{staticClass:"col-md-2 col-12"},[e("FormsFieldsTextComponent",{attrs:{label:"Cliente"},model:{value:t.search.customer,callback:function(e){t.$set(t.search,"customer",e)},expression:"search.customer"}})],1),t._v(" "),e(l.a,{staticClass:"col-md-2 col-12"},[e("FormsFieldsTextComponent",{attrs:{label:"Producto"},model:{value:t.search.product,callback:function(e){t.$set(t.search,"product",e)},expression:"search.product"}})],1),t._v(" "),e(l.a,{staticClass:"col-md-2 col-12"},[e("FormsFieldsTextComponent",{attrs:{label:"Referencia"},model:{value:t.search.reference,callback:function(e){t.$set(t.search,"reference",e)},expression:"search.reference"}})],1),t._v(" "),e(l.a,{staticClass:"col-md-2 col-12"},[e("FormsFieldsTextComponent",{attrs:{type:"date",label:"Fecha inicio"},model:{value:t.search.startDate,callback:function(e){t.$set(t.search,"startDate",e)},expression:"search.startDate"}})],1),t._v(" "),e(l.a,{staticClass:"col-md-2 col-12"},[e("FormsFieldsTextComponent",{attrs:{type:"date",label:"Fecha fin"},model:{value:t.search.endDate,callback:function(e){t.$set(t.search,"endDate",e)},expression:"search.endDate"}})],1),t._v(" "),e(l.a,{staticClass:"col-md-2 col-12"},[e("FormsFieldsSelectComponent",{attrs:{items:t.stateItems,label:"Estado"},model:{value:t.search.state,callback:function(e){t.$set(t.search,"state",e)},expression:"search.state"}})],1)],1)],1),t._v(" "),e(l.a,{staticClass:"col-md-1 col-12 d-flex justify-center align-center"},[e(n.a,{staticClass:"primary white--text mt-4",attrs:{fab:""},on:{click:function(e){return t.getStore()}}},[e(_.a,[t._v("mdi-filter")])],1)],1)],1)],1)],1)],1),t._v(" "),e(c.d,[e(o.a,{staticClass:"rounded-lg",attrs:{outlined:""}},[e(c.d,[e(x.a,{attrs:{"no-gutters":""}},t._l(t.columns,(function(col){return e(y.a,{key:col.value,staticClass:"mr-2 my-2",attrs:{label:col.text},model:{value:col.visible,callback:function(e){t.$set(col,"visible",e)},expression:"col.visible"}})})),1)],1)],1)],1),t._v(" "),e(c.c,[e(m.a,{attrs:{"item-key":"id","show-expand":"","single-expand":"",loading:t.loading,"loading-text":"Cargando ordenes","disable-pagination":"","disable-sort":"","calculate-widths":"","disable-filtering":"",items:t.data.orders,headers:t.filteredColumns,"hide-default-footer":"","items-per-page":10},scopedSlots:t._u([{key:"item.creation_date",fn:function(e){var r=e.item;return[t._v("\n        "+t._s(t._f("formatDate")(r.creation_date))+"\n      ")]}},{key:"item.cost",fn:function(e){var r=e.item;return[t._v("\n        € "+t._s(r.cost)+"\n      ")]}},{key:"item.product.image_url",fn:function(t){var r=t.item;return[e("img",{attrs:{src:r.product.image_url,width:"100%",height:"80"}})]}},{key:"item.products",fn:function(r){var n=r.item;return[e("div",{staticClass:"full-width d-flex flex-column"},t._l(n.products,(function(r){return e(d.a,{key:r.id,staticClass:"mr-2 my-2",attrs:{small:"",label:"",outlined:""}},[t._v("\n            "+t._s(r.name)+"\n          ")])})),1)]}},{key:"item.order.status",fn:function(t){var r=t.item;return[e("storeChipsStatusComponent",{attrs:{status:r.order.status}})]}},{key:"item.product.tracking_number",fn:function(r){var n=r.item;return[e(h.a,{attrs:{"save-text":"Guardar","cancel-text":"Guardar"},on:{close:function(e){return t.updateTrackingOrder(n)},save:function(e){return t.updateTrackingOrder(n)}},scopedSlots:t._u([{key:"input",fn:function(){return[e(C.a,{attrs:{label:"Edit"},model:{value:n.product.tracking_number,callback:function(e){t.$set(n.product,"tracking_number",e)},expression:"item.product.tracking_number"}})]},proxy:!0}],null,!0)},[e(C.a,{attrs:{"hide-details":"",outlined:"",dense:"",height:"20",readonly:"",value:t.setValue("#",n.product.tracking_number)}})],1)]}},{key:"item.product.net_price",fn:function(r){var n=r.item;return[e(h.a,{on:{close:function(e){return t.updateTrackingOrder(n)}},scopedSlots:t._u([{key:"input",fn:function(){return[e(C.a,{attrs:{label:"Edit",counter:""},model:{value:n.product.net_price,callback:function(e){t.$set(n.product,"net_price",e)},expression:"item.product.net_price"}})]},proxy:!0}],null,!0)},[e(C.a,{attrs:{"hide-details":"",outlined:"",dense:"",height:"20",readonly:"",value:t.setValue("€",n.product.net_price)}})],1)]}},{key:"expanded-item",fn:function(r){var n=r.headers,o=r.item;return[e("td",{staticClass:"pa-4",attrs:{colspan:n.length}},[e("ordersIncidencesComponent",{attrs:{store:t.store.id,order:o},on:{refresh:function(e){return t.getStore()}}})],1)]}},{key:"item.copy",fn:function(r){var o=r.item;return[e(n.a,{attrs:{rounded:"",color:"primary"},on:{click:function(e){return t.copyToClipboard(o)}}},[e(_.a,[t._v("mdi-content-copy")])],1)]}},{key:"item.profit",fn:function(e){var r=e.item;return[t._v("\n         "+t._s(t.calcProfit(r))+"\n      ")]}}])})],1),t._v(" "),e(c.a,{staticClass:"d-flex justify-center"},[e(v.a,{attrs:{length:t.data.total_pages,circle:""},model:{value:t.search.page,callback:function(e){t.$set(t.search,"page",e)},expression:"search.page"}})],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{FormsFieldsTextComponent:r(67).default,FormsFieldsSelectComponent:r(91).default,GeneralCardComponent:r(51).default})},889:function(t,e,r){"use strict";r(831)},890:function(t,e,r){var n=r(18)((function(i){return i[1]}));n.push([t.i,".small-card-container[data-v-f67d834a]{height:500px;overflow-x:auto}",""]),n.locals={},t.exports=n},946:function(t,e,r){"use strict";r.r(e);var n=r(294),o=r(2),c=r(292),d=r(781),l=r(763),m=r(287),f=r(896),h=r(225),_=r(771),v=r(97),x=(r(24),r(12),r(8),r(13),r(11),r(14),r(21)),k=r(1),y=(r(65),r(23),r(90),r(74),r(31),r(103),r(9),r(5),r(131)),C=r(4),O=r.n(C),w=r(800);r(799);function S(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function j(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?S(Object(source),!0).forEach((function(e){Object(k.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):S(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var D={mixins:[y.a,w.a],name:"storeCardComponent",props:{store:{type:Object,required:!0}},data:function(){var t;return{expanded:[],mode:"list",filter:"",pagination:{rowsPerPage:10},search:{page:1,state:"2",pageSize:10},loading:!1,data:{orders:[],total_pages:0,total_count:0},columns:[{text:"Order ID",value:"order.id",align:"left",visible:!0},(t={align:"left",text:"Date",value:"order.date_add"},Object(k.a)(t,"align","left"),Object(k.a)(t,"visible",!0),t),{text:"Status",value:"order.status",align:"left",visible:!0},{text:"TotalPrice",value:"product.price",align:"left",visible:!0}],order:{},showOrderModal:!1,earningsByMonth:null,completeStoreModal:!1}},mounted:function(){this.search.startDate=O()().subtract(1,"month").format("YYYY-MM-DD"),this.search.endDate=O()().format("YYYY-MM-DD"),this.getStore(),this.getPaymentsByMonth()},methods:{getPaymentsByMonth:function(){var t=this;this.$axios.get("/webservices/payments/".concat(this.store.id),{params:{store:this.store.id,start_date:O()().startOf("month").format("YYYY-MM-DD"),end_date:O()().endOf("month").format("YYYY-MM-DD"),method:"month"}}).then((function(e){t.earningsByMonth=Object.values(e.data)[0]})).catch((function(){}))},showOrder:function(t){this.order=t,this.showOrderModal=!0},getStore:function(){var t=this;return Object(x.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.$store.dispatch("orderstore/findAll",{storeId:t.store.id,search:t.search});case 3:t.data=e.sent,console.log(t.data),t.loading=!1;case 6:case"end":return e.stop()}}),e)})))()},maximizeWindow:function(){this.$store.dispatch("orderstore/set",this.data),this.$store.dispatch("orderstore/setSearch",this.search),this.completeStoreModal=!0},setValue:function(symbol,t){return t?"".concat(symbol," ").concat(t):"Not setted"},updateTrackingOrder:function(t){var e=this;return Object(x.a)(regeneratorRuntime.mark((function r(){var data,n,o,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(data={product_id:t.product.id,store_id:e.store.id,order_id:t.order.id,net_price:t.product.net_price,tracking_number:t.product.tracking_number,complete_order_data:t},r.prev=1,!t.product.extra_id){r.next=7;break}return r.next=5,e.$axios.put("/orders/".concat(t.product.extra_id),{data:data});case 5:r.next=13;break;case 7:return r.next=9,e.$axios.post("/orders/",{data:data});case 9:n=r.sent,o=n.data,c=e.data.orders.findIndex((function(e){return e.id==t.id})),e.$set(e.data.orders,c,j(j({},e.data.orders[c]),{},{product:j(j({},e.data.orders[c].product),{},{extra_id:o.data.id})}));case 13:t.product.tracking_number&&t.product.tracking_number.length>6&&e.$axios.post("/orders/tracking",data),r.next=19;break;case 16:r.prev=16,r.t0=r.catch(1),console.log(r.t0);case 19:case"end":return r.stop()}}),r,null,[[1,16]])})))()}},computed:{filteredColumns:function(){return this.columns.filter((function(col){return col.visible}))}},watch:{"search.page":function(){this.getStore()}}},$=(r(889),r(10)),component=Object($.a)(D,(function(){var t=this,e=t._self._c;return e("GeneralCardComponent",{staticClass:"mx-auto"},[e("generalCardTitleComponent",{staticClass:"primary white--text"},[t._v(t._s(t.store.name)+"\n    "),e(_.a),t._v(" "),e(c.a,{attrs:{color:"success black--text"}},[t._v("\n      € "+t._s(t.earningsByMonth)+"\n    ")]),t._v(" "),e(n.a,{attrs:{icon:""},on:{click:function(e){return t.maximizeWindow()}}},[e(h.a,{attrs:{color:"white"}},[t._v("mdi-window-maximize")])],1)],1),t._v(" "),e(m.a),t._v(" "),e(o.c,{staticClass:"small-card-container"},[e(d.a,{attrs:{"item-key":"id","show-expand":"","single-expand":"",loading:t.loading,"loading-text":"Cargando ordenes","disable-pagination":"","disable-sort":"","calculate-widths":"","disable-filtering":"",items:t.data.orders,headers:t.filteredColumns,"hide-default-footer":"","items-per-page":10},scopedSlots:t._u([{key:"item.creation_date",fn:function(e){var r=e.item;return[t._v("\n        "+t._s(t._f("formatDate")(r.creation_date))+"\n      ")]}},{key:"item.cost",fn:function(e){var r=e.item;return[t._v("\n        € "+t._s(r.cost)+"\n      ")]}},{key:"item.product.image_url",fn:function(t){var r=t.item;return[e("img",{attrs:{src:r.product.image_url,width:"100%",height:"80"}})]}},{key:"item.products",fn:function(r){var n=r.item;return[e("div",{staticClass:"full-width d-flex flex-column"},t._l(n.products,(function(r){return e(c.a,{key:r.id,staticClass:"mr-2 my-2",attrs:{small:"",label:"",outlined:""}},[t._v("\n            "+t._s(r.name)+"\n          ")])})),1)]}},{key:"item.order.status",fn:function(t){var r=t.item;return[e("storeChipsStatusComponent",{attrs:{status:r.order.status}})]}},{key:"item.product.tracking_number",fn:function(r){var n=r.item;return[e(f.a,{attrs:{"save-text":"Guardar","cancel-text":"Guardar"},on:{close:function(e){return t.updateTrackingOrder(n)},save:function(e){return t.updateTrackingOrder(n)}},scopedSlots:t._u([{key:"input",fn:function(){return[e(v.a,{attrs:{label:"Edit"},model:{value:n.product.tracking_number,callback:function(e){t.$set(n.product,"tracking_number",e)},expression:"item.product.tracking_number"}})]},proxy:!0}],null,!0)},[e(v.a,{attrs:{"hide-details":"",outlined:"",dense:"",height:"20",readonly:"",value:t.setValue("#",n.product.tracking_number)}})],1)]}},{key:"item.product.net_price",fn:function(r){var n=r.item;return[e(f.a,{on:{close:function(e){return t.updateTrackingOrder(n)}},scopedSlots:t._u([{key:"input",fn:function(){return[e(v.a,{attrs:{label:"Edit",counter:""},model:{value:n.product.net_price,callback:function(e){t.$set(n.product,"net_price",e)},expression:"item.product.net_price"}})]},proxy:!0}],null,!0)},[e(v.a,{attrs:{"hide-details":"",outlined:"",dense:"",height:"20",readonly:"",value:t.setValue("€",n.product.net_price)}})],1)]}},{key:"expanded-item",fn:function(r){var n=r.headers,o=r.item;return[e("td",{staticClass:"pa-4",attrs:{colspan:n.length}},[e("ordersIncidencesComponent",{attrs:{store:t.store.id,order:o},on:{refresh:function(e){return t.getStore()}}})],1)]}}])})],1),t._v(" "),e(l.a,{attrs:{fullscreen:""},model:{value:t.completeStoreModal,callback:function(e){t.completeStoreModal=e},expression:"completeStoreModal"}},[t.completeStoreModal?e("StoreCardsComponent",{attrs:{store:t.store}},[e(n.a,{attrs:{icon:""},on:{click:function(e){t.completeStoreModal=!1}}},[e(h.a,{attrs:{color:"white"}},[t._v("mdi-window-minimize")])],1)],1):t._e()],1)],1)}),[],!1,null,"f67d834a",null);e.default=component.exports;installComponents(component,{StoreCardsComponent:r(835).default,GeneralCardComponent:r(51).default})}}]);